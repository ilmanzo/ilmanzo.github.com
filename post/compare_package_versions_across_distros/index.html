<!doctype html><html lang=en><head><title>compare package version across distros &ndash; ilManzo's blog</title><meta name=description content="A minimalist, pragmatic website and personal blog"><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin=anonymous><link rel=stylesheet href=https://ilmanzo.github.io/css/palettes/base16-dark.css><link rel=stylesheet href=https://ilmanzo.github.io/css/risotto.css><link rel=stylesheet href=https://ilmanzo.github.io/css/custom.css></head><body><div class=page><header class=page__header><h1 class=page__logo><a href=https://ilmanzo.github.io/ class=page__logo-inner>ilManzo's blog</a></h1><nav class="page__nav main-nav"><ul><li class=main-nav__item><a class=nav-main-item href=https://ilmanzo.github.io/curriculum title>Curriculum</a></li><li class=main-nav__item><a class=nav-main-item href=https://ilmanzo.github.io/categories title>Categories</a></li><li class=main-nav__item><a class=nav-main-item href=https://ilmanzo.github.io/tags title>Tags</a></li><li class=main-nav__item><a class="nav-main-item active" href=https://ilmanzo.github.io/post/ title=Posts>Posts</a></li></ul></nav></header><section class=page__body><header class=content__header><h1>compare package version across distros</h1></header><div class=content__body><p>Following on the <a href=https://ilmanzo.github.io/post/check-last-update-on-packages/>previous post</a>, I added an useful feature in order to have more information about a package.</p><p>Since I maintain some openSUSE packages, I want to be informed if they gets outdated and if other packagers have released newer versions.
TLDR: This script answers the question &ldquo;Do some of my openSUSE packages have newer versions in other distros?&rdquo;</p><p>You can still find the project repository <a href=https://github.com/ilmanzo/package_last_update>on my github</a>, but we can comment some parts here.</p><p>Other than collecting the package version from Open Build Service, we need to work out how other distro are doing. We could scrape major distros public repositories but turns out there&rsquo;s already an excellent service named <a href=https://repology.org/>repology</a> that exposes some API that can easily be queried:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>REPOLOGY_APIURL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://repology.org/api/v1/project/&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># return a package info when its version is different than the reference one</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_repology_version</span>(package, refversion):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>REPOLOGY_APIURL<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>package<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> [r <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> response<span style=color:#f92672>.</span>json() <span style=color:#66d9ef>if</span> r[<span style=color:#e6db74>&#39;status&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;newest&#39;</span> <span style=color:#f92672>and</span> r[<span style=color:#e6db74>&#39;version&#39;</span>] <span style=color:#f92672>!=</span> refversion]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span></span></span></code></pre></div><p>A companion shell script gets the info for all the packages I&rsquo;m in charge of; I run it on every morning login so I won&rsquo;t risk to forget something.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> p in <span style=color:#66d9ef>$(</span>osc -A https://api.opensuse.org my packages | cut -d <span style=color:#e6db74>&#39;/&#39;</span> -f 2<span style=color:#66d9ef>)</span> ; <span style=color:#66d9ef>do</span> ./last_update $p ; <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rang last version on openSUSE:Factory is 3.2 changed on Dec <span style=color:#ae81ff>17</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>Other repos may have newer versions, consider updating!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pgn-extract last version on openSUSE:Factory is 22.11 changed on Dec <span style=color:#ae81ff>23</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>No newer versions found in other repositories
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flacon last version on openSUSE:Factory is 9.5.1 changed on Dec <span style=color:#ae81ff>26</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>No newer versions found in other repositories
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>goodvibes last version on openSUSE:Factory is 0.7.5 changed on Oct <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>No newer versions found in other repositories
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>openconnect last version on openSUSE:Factory is 9.01 changed on Dec <span style=color:#ae81ff>15</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>No newer versions found in other repositories
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oidentd last version on openSUSE:Factory is 3.0.0 changed on Oct <span style=color:#ae81ff>21</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>No newer versions found in other repositories
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pgbackrest last version on openSUSE:Factory is 2.43 changed on Dec <span style=color:#ae81ff>07</span> <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>No newer versions found in other repositories</span></span></code></pre></div><p>There are of course lot of possible improvements. For example use directly <a href=https://github.com/crazyscientist/osc-tiny>osc-tiny</a> by <a href=https://github.com/crazyscientist>Andreas Hasenkopf</a> and improve the OBS version detection . Pull requests are welcome!</p><p>Have fun ;)</p></div><footer class=content__footer></footer></section><section class=page__aside><div class=aside__about><div class=aside__about><img class=about__logo src=https://ilmanzo.github.io/images/rice.svg alt=Logo><h1 class=about__title>Andrea Manzini</h1><p class=about__description>A minimalist, pragmatic website and personal blog</p></div><ul class=aside__social-links><li><a href=https://github.com/ilmanzo rel=me aria-label=GitHub title=GitHub><i class="fab fa-github" aria-hidden=true></i></a>&nbsp;</li><li><a href=mailto:ilmanzo@gmail.com rel=me aria-label=Email title=Email><i class="fas fa-envelope" aria-hidden=true></i></a>&nbsp;</li><li><a href=https://www.linkedin.com/in/andreamanzini rel=me aria-label=Linkedin title=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a>&nbsp;</li><li><a href=https://twitter.com/ilmanzo rel=me aria-label=Twitter title=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a>&nbsp;</li><li><a href=https://ilmanzo.github.io/index.xml rel=me aria-label="RSS Feed" title="RSS Feed"><i class="fas fa-rss-square" aria-hidden=true></i></a>&nbsp;</li></ul></div><hr><div class=aside__content><p>a tool to check if an openSUSE package version is up to date against other distros</p><p>By Andrea Manzini,
2023-01-08</p></div></section><footer class=page__footer><p></p><br><br><p class=copyright>Â© 2022 Andrea Manzini</p><p class=advertisement>Powered by <a href=https://gohugo.io/>hugo</a> and <a href=https://github.com/joeroe/risotto>risotto</a>.</p></footer></div></body></html>