<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>compare package version across distros | ilManzo's blog</title>
<meta name=keywords content="linux,bash,programming,testing,automation,python"><meta name=description content="a tool to check if an openSUSE package version is up to date against other distros"><meta name=author content="Andrea Manzini"><link rel=canonical href=https://ilmanzo.github.io/post/compare_package_versions_across_distros/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://ilmanzo.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ilmanzo.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ilmanzo.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ilmanzo.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ilmanzo.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6PN4FTRLNL"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6PN4FTRLNL",{anonymize_ip:!1})}</script><meta property="og:title" content="compare package version across distros"><meta property="og:description" content="a tool to check if an openSUSE package version is up to date against other distros"><meta property="og:type" content="article"><meta property="og:url" content="https://ilmanzo.github.io/post/compare_package_versions_across_distros/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-01-09T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-09T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="compare package version across distros"><meta name=twitter:description content="a tool to check if an openSUSE package version is up to date against other distros"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ilmanzo.github.io/post/"},{"@type":"ListItem","position":2,"name":"compare package version across distros","item":"https://ilmanzo.github.io/post/compare_package_versions_across_distros/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"compare package version across distros","name":"compare package version across distros","description":"a tool to check if an openSUSE package version is up to date against other distros","keywords":["linux","bash","programming","testing","automation","python"],"articleBody":"TLDR: This script now answers the question “Do some of my openSUSE packages have newer versions in other distros?”\nAs a following on previous post, I added an useful feature in order to have more information about a package. Since I maintain some openSUSE packages, I want to be informed if they gets outdated and if other packagers have released newer versions.\nYou can still find the project repository on my github, but we can comment some parts here.\nOther than collecting the package version from Open Build Service, we need to find out how the same packages in other distro are doing. We could scrape major distros public repositories but turns out there’s already an excellent service named repology that exposes some API that can easily be queried:\nREPOLOGY_APIURL = 'https://repology.org/api/v1/project/' # return a package info when its version is different than the reference one def get_repology_version(package, refversion): try: response = requests.get(f\"{REPOLOGY_APIURL}/{package}\") return [r for r in response.json() if r['status'] == 'newest' and r['version'] != refversion] except: return None A companion shell script gets the info for all the packages I’m in charge of; I run it on every morning login so I won’t risk to forget something.\n#!/bin/sh for p in $(osc -A https://api.opensuse.org my packages | cut -d '/' -f 2) ; do ./last_update $p ; done which outputs:\n- rang last version on openSUSE:Factory is 3.2 changed on Dec 17 2022 Other 7 repos may have newer versions, consider updating! - pgn-extract last version on openSUSE:Factory is 22.11 changed on Dec 23 2022 - flacon last version on openSUSE:Factory is 9.5.1 changed on Dec 26 2022 - goodvibes last version on openSUSE:Factory is 0.7.5 changed on Oct 16 2022 - openconnect last version on openSUSE:Factory is 9.01 changed on Dec 15 2022 - oidentd last version on openSUSE:Factory is 3.0.0 changed on Oct 21 2022 - pgbackrest last version on openSUSE:Factory is 2.43 changed on Dec 07 2022 There are of course tons of possible improvements. For example use directly osc-tiny by Andreas Hasenkopf and improve the OBS version detection. At this stage for example it does not yet support rpm macros. Pull requests are welcome!\nHave fun ;)\n","wordCount":"363","inLanguage":"en","datePublished":"2023-01-09T00:00:00Z","dateModified":"2023-01-09T00:00:00Z","author":{"@type":"Person","name":"Andrea Manzini"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ilmanzo.github.io/post/compare_package_versions_across_distros/"},"publisher":{"@type":"Organization","name":"ilManzo's blog","logo":{"@type":"ImageObject","url":"https://ilmanzo.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ilmanzo.github.io/ accesskey=h title="ilManzo's blog (Alt + H)">ilManzo's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ilmanzo.github.io/curriculum title=Curriculum><span>Curriculum</span></a></li><li><a href=https://ilmanzo.github.io/tags title=Tags><span>Tags</span></a></li><li><a href=https://ilmanzo.github.io/categories title=Categories><span>Categories</span></a></li><li><a href=https://ilmanzo.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ilmanzo.github.io/post/ title=Posts><span>Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ilmanzo.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://ilmanzo.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">compare package version across distros</h1><div class=post-description>a tool to check if an openSUSE package version is up to date against other distros</div><div class=post-meta><span title='2023-01-09 00:00:00 +0000 UTC'>January 9, 2023</span>&nbsp;·&nbsp;Andrea Manzini</div></header><div class=post-content><p>TLDR: This script now answers the question &ldquo;Do some of my openSUSE packages have newer versions in other distros?&rdquo;</p><p>As a following on <a href=https://ilmanzo.github.io/post/check-last-update-on-packages/>previous post</a>, I added an useful feature in order to have more information about a package.
Since I maintain some openSUSE packages, I want to be informed if they gets outdated and if other packagers have released newer versions.</p><p>You can still find the project repository <a href=https://github.com/ilmanzo/package_last_update>on my github</a>, but we can comment some parts here.</p><p>Other than collecting the package version from Open Build Service, we need to find out how the same packages in other distro are doing. We could scrape major distros public repositories but turns out there&rsquo;s already an excellent service named <a href=https://repology.org/>repology</a> that exposes some API that can easily be queried:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>REPOLOGY_APIURL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://repology.org/api/v1/project/&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># return a package info when its version is different than the reference one</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_repology_version</span>(package, refversion):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>REPOLOGY_APIURL<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>package<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> [r <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> response<span style=color:#f92672>.</span>json() <span style=color:#66d9ef>if</span> r[<span style=color:#e6db74>&#39;status&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;newest&#39;</span> <span style=color:#f92672>and</span> r[<span style=color:#e6db74>&#39;version&#39;</span>] <span style=color:#f92672>!=</span> refversion]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span></span></span></code></pre></div><p>A companion shell script gets the info for all the packages I&rsquo;m in charge of; I run it on every morning login so I won&rsquo;t risk to forget something.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> p in <span style=color:#66d9ef>$(</span>osc -A https://api.opensuse.org my packages | cut -d <span style=color:#e6db74>&#39;/&#39;</span> -f 2<span style=color:#66d9ef>)</span> ; <span style=color:#66d9ef>do</span> ./last_update $p ; <span style=color:#66d9ef>done</span></span></span></code></pre></div><p>which outputs:</p><pre><code>- rang last version on openSUSE:Factory is 3.2 changed on Dec 17 2022
  Other 7 repos may have newer versions, consider updating!
- pgn-extract last version on openSUSE:Factory is 22.11 changed on Dec 23 2022
- flacon last version on openSUSE:Factory is 9.5.1 changed on Dec 26 2022
- goodvibes last version on openSUSE:Factory is 0.7.5 changed on Oct 16 2022
- openconnect last version on openSUSE:Factory is 9.01 changed on Dec 15 2022
- oidentd last version on openSUSE:Factory is 3.0.0 changed on Oct 21 2022
- pgbackrest last version on openSUSE:Factory is 2.43 changed on Dec 07 2022
</code></pre><p>There are of course tons of possible improvements. For example use directly <a href=https://github.com/crazyscientist/osc-tiny>osc-tiny</a> by <a href=https://github.com/crazyscientist>Andreas Hasenkopf</a> and improve the OBS version detection. At this stage for example it does not yet support rpm macros. Pull requests are welcome!</p><p>Have fun ;)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ilmanzo.github.io/tags/linux/>linux</a></li><li><a href=https://ilmanzo.github.io/tags/bash/>bash</a></li><li><a href=https://ilmanzo.github.io/tags/programming/>programming</a></li><li><a href=https://ilmanzo.github.io/tags/testing/>testing</a></li><li><a href=https://ilmanzo.github.io/tags/automation/>automation</a></li><li><a href=https://ilmanzo.github.io/tags/python/>python</a></li></ul><nav class=paginav><a class=prev href=https://ilmanzo.github.io/post/suse-hackweek-2023-recap/><span class=title>« Prev</span><br><span>a SUSE hackweek22 report</span>
</a><a class=next href=https://ilmanzo.github.io/post/check-last-update-on-packages/><span class=title>Next »</span><br><span>get update info about packages</span></a></nav></footer></article></main><footer class=footer><span>© 2012-2024 Andrea Manzini</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>