<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Automated files cleanup on Linux | ilManzo's blog</title><meta name=keywords content="linux,systemd,opensuse,timers,sysadmin,cleanup"><meta name=description content="üöÆ Or: how I taught my Linux box to take out its own trash"><meta name=author content="Andrea Manzini"><link rel=canonical href=https://ilmanzo.github.io/post/my-linux-janitor/><link crossorigin=anonymous href=/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn+yY=" rel="preload stylesheet" as=style><link rel=icon href=https://ilmanzo.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ilmanzo.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ilmanzo.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ilmanzo.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ilmanzo.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ilmanzo.github.io/post/my-linux-janitor/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6PN4FTRLNL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6PN4FTRLNL")}</script><meta property="og:url" content="https://ilmanzo.github.io/post/my-linux-janitor/"><meta property="og:site_name" content="ilManzo's blog"><meta property="og:title" content="Automated files cleanup on Linux"><meta property="og:description" content="üöÆ Or: how I taught my Linux box to take out its own trash"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-10-23T00:00:00+00:00"><meta property="article:modified_time" content="2025-10-23T00:00:00+00:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Systemd"><meta property="article:tag" content="Opensuse"><meta property="article:tag" content="Timers"><meta property="article:tag" content="Sysadmin"><meta property="article:tag" content="Cleanup"><meta name=twitter:card content="summary"><meta name=twitter:title content="Automated files cleanup on Linux"><meta name=twitter:description content="üöÆ Or: how I taught my Linux box to take out its own trash"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ilmanzo.github.io/post/"},{"@type":"ListItem","position":2,"name":"Automated files cleanup on Linux","item":"https://ilmanzo.github.io/post/my-linux-janitor/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Automated files cleanup on Linux","name":"Automated files cleanup on Linux","description":"üöÆ Or: how I taught my Linux box to take out its own trash","keywords":["linux","systemd","opensuse","timers","sysadmin","cleanup"],"articleBody":"üßπ My Messy Linux Box As year passes, my Linux system, over the time, starts to get a little‚Ä¶ Messy.\nMy ~/Downloads directory is a digital dumping ground. It‚Äôs a collection of ISOs, test scripts, and those huge multi-gigabyte Virtual Machine images I need to test once and then forget about. Add to that ~/Pictures/Screenshots, which is overflowing with thousands of quick snaps I‚Äôll never look at again.\nDisk space is cheap nowadays, but I like to have things nice and clean. I could go in and manually clean it‚Ä¶ But who remembers to do that ?\nSo I setup a quick automated solution; it turns out as a good occation to study Systemd timers!\nMy rule is simple: if I haven‚Äôt accessed (or ‚Äúopened‚Äù) a file in either of those places for 30 days, I consider it junk and want it gone.\n(please forgive the mandatory cheesy AI-generated picture)\nüóÇÔ∏è Your Own Systemd Janitor We just need to create two simple text files:\nA .service file: This tells the janitor what to do. A .timer file: This tells the janitor when to do it. First, we need a place to put our new files. Systemd looks for user files in ~/.config/systemd/user/.\nmkdir -p ~/.config/systemd/user/ The first file will define the cleanup command. Create a new file named ~/.config/systemd/user/cleanup-files.service:\n[Unit] Description=Clean up old files in Download and Screenshots [Service] Type=oneshot ExecStart=/usr/bin/find %h/Downloads %h/Pictures/Screenshots -type f -atime +29 -delete Nice=19 IOSchedulingClass=idle Let‚Äôs break that down:\nType=oneshot: This just means it runs a single command and stops. ExecStart=...: This is the magic command! %h/Downloads %h/Pictures/Screenshots: %h is systemd‚Äôs special shortcut for your home directory. We tell find to look in both places. -type f: Only find files, not empty directories. -atime +29: Find files that were last accessed more than 29 days ago (i.e., 30 days or more). -delete: Yep. It deletes them. Nice=19 \u0026 IOSchedulingClass=idle: These are good manners. They tell the system to run this command with the lowest possible priority, so it never slows down your real work. note: if your /home/ filesystem is mounted with noatime or relatime options to improve performance, you might get more predictable results by using mtime (modification time) instead. This would delete files that haven‚Äôt been changed in 30 days.\n‚ö†Ô∏è Safety Warning! Before you let this run, do a dry run! Copy the command into your terminal, but remove the -delete part.\n# THIS WILL ONLY LIST FILES. IT WILL NOT DELETE ANYTHING. find ~/Downloads ~/Pictures/Screenshots -type f -atime +29 Now, let‚Äôs make the schedule.\nCreate a new file named ~/.config/systemd/user/cleanup-files.timer:\n[Unit] Description=Run cleanup-files.service daily [Timer] OnCalendar=daily Persistent=true [Install] WantedBy=timers.target This one is simple:\nOnCalendar=daily: Run this once a day. (It usually runs around midnight). Persistent=true: This is the best part. If your computer was off at midnight, it will run the command as soon as you boot up and log in.` ‚è≤Ô∏è Start Your Timer! You‚Äôve built the janitor; Time to turn it on. Tell systemd to read your new files:\nsystemctl --user daemon-reload Enable and start the timer:\nsystemctl --user enable --now cleanup-files.timer You can check that your timer is active and waiting by running:\nsystemctl --user status cleanup-files.timer systemctl --user list-timers üóëÔ∏è Bonus Step: Package Cleanup (for openSUSE ü¶é users) File cleanup is great, but as a Tumbleweed user, My system gets constant updates, which can leave behind ‚Äúunneeded‚Äù packages‚Äîdependencies that were installed for something but are no longer required. So I have also an handy alias\nalias zclean='zypper packages --orphaned \u0026\u0026 zypper packages --unneeded' that shows me potential candidate packages , which I can then remove with their dependencies :\nzypper rm -u Enjoy your cleaner system and Happy Hacking!\n","wordCount":"613","inLanguage":"en","datePublished":"2025-10-23T00:00:00Z","dateModified":"2025-10-23T00:00:00Z","author":{"@type":"Person","name":"Andrea Manzini"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ilmanzo.github.io/post/my-linux-janitor/"},"publisher":{"@type":"Organization","name":"ilManzo's blog","logo":{"@type":"ImageObject","url":"https://ilmanzo.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ilmanzo.github.io/ accesskey=h title="ilManzo's blog (Alt + H)">ilManzo's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ilmanzo.github.io/curriculum title=Curriculum><span>Curriculum</span></a></li><li><a href=https://ilmanzo.github.io/tags title=Tags><span>Tags</span></a></li><li><a href=https://ilmanzo.github.io/categories title=Categories><span>Categories</span></a></li><li><a href=https://ilmanzo.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ilmanzo.github.io/post/ title=Posts><span>Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ilmanzo.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://ilmanzo.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Automated files cleanup on Linux</h1><div class=post-description>üöÆ Or: how I taught my Linux box to take out its own trash</div><div class=post-meta><span title='2025-10-23 00:00:00 +0000 UTC'>October 23, 2025</span>&nbsp;¬∑&nbsp;<span>Andrea Manzini</span></div></header><div class=post-content><h2 id=-my-messy-linux-box>üßπ My Messy Linux Box<a hidden class=anchor aria-hidden=true href=#-my-messy-linux-box>#</a></h2><p>As year passes, my Linux system, over the time, starts to get a little&mldr; <em>Messy</em>.</p><p>My <code>~/Downloads</code> directory is a digital dumping ground. It&rsquo;s a collection of ISOs, test scripts, and those huge multi-gigabyte Virtual Machine images I need to test once and then forget about. Add to that <code>~/Pictures/Screenshots</code>, which is overflowing with thousands of quick snaps I&rsquo;ll never look at again.</p><p>Disk space is cheap nowadays, but I like to have things nice and clean. I could go in and manually clean it&mldr; But who remembers to do that ?</p><p>So I setup a quick automated solution; it turns out as a good occation to study <strong>Systemd timers!</strong></p><p>My rule is simple: if I haven&rsquo;t accessed (or &ldquo;opened&rdquo;) a file in either of those places for 30 days, I consider it junk and want it gone.</p><p><img alt="linux janitor" loading=lazy src=/img/linux_janitor.jpg></p><p><em>(please forgive the mandatory cheesy AI-generated picture)</em></p><h2 id=-your-own-systemd-janitor>üóÇÔ∏è Your Own Systemd Janitor<a hidden class=anchor aria-hidden=true href=#-your-own-systemd-janitor>#</a></h2><p>We just need to create two simple text files:</p><ul><li>A <code>.service</code> file: This tells the janitor what to do.</li><li>A <code>.timer</code> file: This tells the janitor when to do it.</li></ul><p>First, we need a place to put our new files. Systemd looks for user files in <code>~/.config/systemd/user/</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p ~/.config/systemd/user/
</span></span></code></pre></div><p>The first file will define the cleanup command.
Create a new file named <code>~/.config/systemd/user/cleanup-files.service</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Clean up old files in Download and Screenshots</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Service]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>oneshot</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/bin/find %h/Downloads %h/Pictures/Screenshots -type f -atime +29 -delete</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Nice</span><span style=color:#f92672>=</span><span style=color:#e6db74>19</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>IOSchedulingClass</span><span style=color:#f92672>=</span><span style=color:#e6db74>idle</span>
</span></span></code></pre></div><p>Let&rsquo;s break that down:</p><ul><li><code>Type=oneshot</code>: This just means it runs a single command and stops.</li><li><code>ExecStart=...</code>: This is the magic command!</li><li><code>%h/Downloads %h/Pictures/Screenshots</code>: %h is systemd&rsquo;s special shortcut for your home directory. We tell find to look in both places.</li><li><code>-type f</code>: Only find files, not empty directories.</li><li><code>-atime +29</code>: Find files that were last accessed more than 29 days ago (i.e., 30 days or more).</li><li><code>-delete</code>: Yep. It deletes them.</li><li><code>Nice=19 & IOSchedulingClass=idle</code>: These are good manners. They tell the system to run this command with the lowest possible priority, so it never slows down your real work.</li></ul><p>note: if your <code>/home/</code> filesystem is mounted with <code>noatime</code> or <code>relatime</code> options to improve performance, you might get more predictable results by using <code>mtime</code> (modification time) instead. This would delete files that haven&rsquo;t been changed in 30 days.</p><p>‚ö†Ô∏è Safety Warning! Before you let this run, do a dry run! Copy the command into your terminal, but remove the <code>-delete</code> part.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># THIS WILL ONLY LIST FILES. IT WILL NOT DELETE ANYTHING.</span>
</span></span><span style=display:flex><span>find ~/Downloads ~/Pictures/Screenshots -type f -atime +29
</span></span></code></pre></div><p>Now, let&rsquo;s make the schedule.</p><p>Create a new file named <code>~/.config/systemd/user/cleanup-files.timer</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Run cleanup-files.service daily</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Timer]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>OnCalendar</span><span style=color:#f92672>=</span><span style=color:#e6db74>daily</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Persistent</span><span style=color:#f92672>=</span><span style=color:#e6db74>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Install]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>WantedBy</span><span style=color:#f92672>=</span><span style=color:#e6db74>timers.target</span>
</span></span></code></pre></div><p>This one is simple:</p><ul><li><code>OnCalendar=daily</code>: Run this once a day. (It usually runs around midnight).</li><li><code>Persistent=true</code>: This is the best part. If your computer was off at midnight, it will run the command as soon as you boot up and log in.`</li></ul><h2 id=-start-your-timer>‚è≤Ô∏è Start Your Timer!<a hidden class=anchor aria-hidden=true href=#-start-your-timer>#</a></h2><p>You&rsquo;ve built the janitor; Time to turn it on.
Tell systemd to read your new files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl --user daemon-reload
</span></span></code></pre></div><p>Enable and start the timer:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl --user enable --now cleanup-files.timer
</span></span></code></pre></div><p>You can check that your timer is active and waiting by running:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl --user status cleanup-files.timer
</span></span><span style=display:flex><span>systemctl --user list-timers
</span></span></code></pre></div><h2 id=-bonus-step-package-cleanup>üóëÔ∏è Bonus Step: Package Cleanup<a hidden class=anchor aria-hidden=true href=#-bonus-step-package-cleanup>#</a></h2><h3 id=for-opensuse--users>(for openSUSE ü¶é users)<a hidden class=anchor aria-hidden=true href=#for-opensuse--users>#</a></h3><p>File cleanup is great, but as a Tumbleweed user, My system gets constant updates, which can leave behind &ldquo;unneeded&rdquo; packages‚Äîdependencies that were installed for something but are no longer required. So I have also an handy alias</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>alias zclean<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;zypper packages --orphaned &amp;&amp; zypper packages --unneeded&#39;</span>
</span></span></code></pre></div><p>that shows me potential candidate packages , which I can then remove with their dependencies :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>zypper rm -u &lt;PACKAGENAME&gt;
</span></span></code></pre></div><p>Enjoy your cleaner system and Happy Hacking!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ilmanzo.github.io/tags/linux/>Linux</a></li><li><a href=https://ilmanzo.github.io/tags/systemd/>Systemd</a></li><li><a href=https://ilmanzo.github.io/tags/opensuse/>Opensuse</a></li><li><a href=https://ilmanzo.github.io/tags/timers/>Timers</a></li><li><a href=https://ilmanzo.github.io/tags/sysadmin/>Sysadmin</a></li><li><a href=https://ilmanzo.github.io/tags/cleanup/>Cleanup</a></li></ul><nav class=paginav><a class=next href=https://ilmanzo.github.io/post/qboot-qemu-helper/><span class=title>Next ¬ª</span><br><span>From QEMU Headache to Headless</span></a></nav></footer></article></main><footer class=footer><span>¬© 2012-2025 Andrea Manzini</span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>