<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>web components with Nim and Karax | ilManzo's blog</title><meta name=keywords content="nim,nim_language,web,programming"><meta name=description content="how to create a simple web component in a Karax web application"><meta name=author content="Andrea Manzini"><link rel=canonical href=https://ilmanzo.github.io/post/nim-frontend-web-development-with-karax/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://ilmanzo.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ilmanzo.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ilmanzo.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ilmanzo.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ilmanzo.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ilmanzo.github.io/post/nim-frontend-web-development-with-karax/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6PN4FTRLNL"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6PN4FTRLNL")}</script><meta property="og:url" content="https://ilmanzo.github.io/post/nim-frontend-web-development-with-karax/"><meta property="og:site_name" content="ilManzo's blog"><meta property="og:title" content="web components with Nim and Karax"><meta property="og:description" content="how to create a simple web component in a Karax web application"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-07-07T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-07T00:00:00+00:00"><meta property="article:tag" content="Nim"><meta property="article:tag" content="Nim_language"><meta property="article:tag" content="Web"><meta property="article:tag" content="Programming"><meta name=twitter:card content="summary"><meta name=twitter:title content="web components with Nim and Karax"><meta name=twitter:description content="how to create a simple web component in a Karax web application"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ilmanzo.github.io/post/"},{"@type":"ListItem","position":2,"name":"web components with Nim and Karax","item":"https://ilmanzo.github.io/post/nim-frontend-web-development-with-karax/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"web components with Nim and Karax","name":"web components with Nim and Karax","description":"how to create a simple web component in a Karax web application","keywords":["nim","nim_language","web","programming"],"articleBody":"Inspired by a tweet from a fellow developer, I decided to take a look at Karax, a nifty framework for developing single page applications in Nim.\nAfter following the basic tutorials and examples, I searched for something more complex and found very sparse documentation, so I’ll write my findings here.\nAs usual, the complete source code is on my github repo, where you can find also a working live demo.\nIn this example I wanted to experiment with the component pattern, and create a stateful module that can be reused. So I modeled a nim clock object, here the source:\n# source for the Clock component import karax/[karax, karaxdsl, vdom] import std/times import std/dom import sugar type KClock* = ref object of VComponent currentTime: DateTime offset: TimeInterval timer: TimeOut prefix: string # return a VNode with the html rendered for the component proc render(c: VComponent): VNode = let self = KClock(c) buildHtml(tdiv): let value = format(self.currentTime+self.offset, \"HH:mm:ss\") p: text \"Local Time \" \u0026 self.prefix \u0026 \" =\u003e \" \u0026 value # update the clock value and re-triggers a timer proc update(self: KClock) = self.currentTime = now() self.timer = setTimeout( () =\u003e self.update, 100) markDirty(self) # need to be re-rendered redraw() # create, initialize and return a new Clock object proc new*(T: type KClock, tzoffset = 0): KClock = let self = newComponent(KClock, render) self.currentTime = now() self.offset = initTimeInterval(hours = tzoffset) self.timer = setTimeout(() =\u003e self.update, 100) self.prefix = if tzoffset \u003e= 0: \"+\" else: \"\" self.prefix.add $tzoffset return self this lives in a separate file and can be imported from the main page.\nSome attention point goes in the constructor, that requires special newComponent call, and the update() function that contains a Timeout callback in order to re-render itself after some time.\nlet’s use the component in the main page, and sprinkle some interactivity just for fun:\nimport karax / [kbase, vdom, kdom, karax, karaxdsl, jstrutils] import kclock var clocks: seq[KClock] # keep a list of clocks offset: kstring # value entered in the input box proc render(): VNode = buildHtml(tdiv): h2: label(`for` = \"offset\"): text \"Please enter Timezone offset (-12 .. +12)\" input(type = \"number\", id = \"offset\"): proc oninput(ev: Event; n: VNode) = offset = n.value button: text \"Add a new Clock\" proc onclick(ev: Event; n: VNode) = let tzofs = parseInt(offset) if tzofs \u003e= -12 and tzofs \u003c= 12: clocks.add(KClock.new(tzofs)) button: text \"Remove last Clock\" proc onclick(ev: Event; n: VNode) = discard clocks.pop() for clock in clocks: h1: clock setRenderer render for Nim lovers, Karax looks promising, and programming web pages without writing a single Javascript line sounds very interesting; but currently it needs some polish, more documentation and a larger user base. So try and contribute to the development community!\n","wordCount":"455","inLanguage":"en","datePublished":"2022-07-07T00:00:00Z","dateModified":"2022-07-07T00:00:00Z","author":{"@type":"Person","name":"Andrea Manzini"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ilmanzo.github.io/post/nim-frontend-web-development-with-karax/"},"publisher":{"@type":"Organization","name":"ilManzo's blog","logo":{"@type":"ImageObject","url":"https://ilmanzo.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ilmanzo.github.io/ accesskey=h title="ilManzo's blog (Alt + H)">ilManzo's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ilmanzo.github.io/curriculum title=Curriculum><span>Curriculum</span></a></li><li><a href=https://ilmanzo.github.io/tags title=Tags><span>Tags</span></a></li><li><a href=https://ilmanzo.github.io/categories title=Categories><span>Categories</span></a></li><li><a href=https://ilmanzo.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://ilmanzo.github.io/post/ title=Posts><span>Posts</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ilmanzo.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://ilmanzo.github.io/post/>Posts</a></div><h1 class="post-title entry-hint-parent">web components with Nim and Karax</h1><div class=post-description>how to create a simple web component in a Karax web application</div><div class=post-meta><span title='2022-07-07 00:00:00 +0000 UTC'>July 7, 2022</span>&nbsp;·&nbsp;Andrea Manzini</div></header><div class=post-content><p>Inspired by a <a href="https://twitter.com/pietroppeter/status/1542484628531019776?s=20&amp;t=GZdX9XAmh1pGTka2hj8OVQ">tweet</a> from a fellow developer, I decided to take a look at <a href=https://github.com/karaxnim/karax>Karax</a>, a nifty framework for developing single page applications in Nim.</p><p>After following the basic tutorials and examples, I searched for something more complex and found very sparse documentation, so I&rsquo;ll write my findings here.</p><p>As usual, the complete source code is <a href=https://github.com/ilmanzo/karax_clock>on my github repo</a>, where you can find also a working <a href=https://ilmanzo.github.io/karax_clock/>live demo</a>.</p><p>In this example I wanted to experiment with the component pattern, and create a stateful module that can be reused. So I modeled a nim <em>clock</em> object, here the source:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nim data-lang=nim><span style=display:flex><span><span style=color:#75715e># source for the Clock component</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> karax<span style=color:#f92672>/[</span>karax, karaxdsl, vdom<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> std<span style=color:#f92672>/</span>times
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> std<span style=color:#f92672>/</span>dom
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sugar
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span>
</span></span><span style=display:flex><span>  KClock<span style=color:#f92672>*</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>ref</span> <span style=color:#66d9ef>object</span> <span style=color:#66d9ef>of</span> VComponent
</span></span><span style=display:flex><span>    currentTime: DateTime
</span></span><span style=display:flex><span>    offset: TimeInterval
</span></span><span style=display:flex><span>    timer: TimeOut
</span></span><span style=display:flex><span>    prefix: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># return a VNode with the html rendered for the component</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>proc </span><span style=color:#a6e22e>render</span>(c: VComponent): VNode <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> self <span style=color:#f92672>=</span> KClock(c)
</span></span><span style=display:flex><span>  buildHtml(tdiv):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> value <span style=color:#f92672>=</span> format(self.currentTime<span style=color:#f92672>+</span>self.offset, <span style=color:#e6db74>&#34;HH:mm:ss&#34;</span>)
</span></span><span style=display:flex><span>    p:
</span></span><span style=display:flex><span>      text <span style=color:#e6db74>&#34;Local Time &#34;</span> <span style=color:#f92672>&amp;</span> self.prefix <span style=color:#f92672>&amp;</span> <span style=color:#e6db74>&#34; =&gt; &#34;</span> <span style=color:#f92672>&amp;</span> value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># update the clock value and re-triggers a timer</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>proc </span><span style=color:#a6e22e>update</span>(self: KClock) <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  self.currentTime <span style=color:#f92672>=</span> now()
</span></span><span style=display:flex><span>  self.timer <span style=color:#f92672>=</span> setTimeout( () <span style=color:#f92672>=&gt;</span> self.update, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>  markDirty(self) <span style=color:#75715e># need to be re-rendered</span>
</span></span><span style=display:flex><span>  redraw()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># create, initialize and return a new Clock object</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>proc </span><span style=color:#a6e22e>new</span><span style=color:#f92672>*</span>(T: <span style=color:#66d9ef>type</span> KClock, tzoffset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>): KClock <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> self <span style=color:#f92672>=</span> newComponent(KClock, render)
</span></span><span style=display:flex><span>  self.currentTime <span style=color:#f92672>=</span> now()
</span></span><span style=display:flex><span>  self.offset <span style=color:#f92672>=</span> initTimeInterval(hours <span style=color:#f92672>=</span> tzoffset)
</span></span><span style=display:flex><span>  self.timer <span style=color:#f92672>=</span> setTimeout(() <span style=color:#f92672>=&gt;</span> self.update, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>  self.prefix <span style=color:#f92672>=</span> <span style=color:#66d9ef>if</span> tzoffset <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>: <span style=color:#e6db74>&#34;+&#34;</span> <span style=color:#66d9ef>else</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  self.prefix.add <span style=color:#f92672>$</span>tzoffset
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> self</span></span></code></pre></div><p>this lives in a separate file and can be imported from the main page.</p><p>Some attention point goes in the constructor, that requires special <code>newComponent</code> call, and the <code>update()</code> function that contains a Timeout callback in order to re-render itself after some time.</p><p>let&rsquo;s use the component in the main page, and sprinkle some interactivity just for fun:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nim data-lang=nim><span style=display:flex><span><span style=color:#f92672>import</span> karax <span style=color:#f92672>/</span> <span style=color:#f92672>[</span>kbase, vdom, kdom, karax, karaxdsl, jstrutils<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> kclock
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span>
</span></span><span style=display:flex><span>  clocks: <span style=color:#66d9ef>seq</span><span style=color:#f92672>[</span>KClock<span style=color:#f92672>]</span> <span style=color:#75715e># keep a list of clocks</span>
</span></span><span style=display:flex><span>  offset: kstring     <span style=color:#75715e># value entered in the input box</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>proc </span><span style=color:#a6e22e>render</span>(): VNode <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  buildHtml(tdiv):
</span></span><span style=display:flex><span>    h2:
</span></span><span style=display:flex><span>      label(`<span style=color:#66d9ef>for</span>` <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;offset&#34;</span>):
</span></span><span style=display:flex><span>        text <span style=color:#e6db74>&#34;Please enter Timezone offset (-12 .. +12)&#34;</span>
</span></span><span style=display:flex><span>      input(<span style=color:#66d9ef>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;number&#34;</span>, id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;offset&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>proc </span><span style=color:#a6e22e>oninput</span>(ev: Event; n: VNode) <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>          offset <span style=color:#f92672>=</span> n.value
</span></span><span style=display:flex><span>    button:
</span></span><span style=display:flex><span>      text <span style=color:#e6db74>&#34;Add a new Clock&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>proc </span><span style=color:#a6e22e>onclick</span>(ev: Event; n: VNode) <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> tzofs <span style=color:#f92672>=</span> parseInt(offset)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> tzofs <span style=color:#f92672>&gt;=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>12</span> <span style=color:#f92672>and</span> tzofs <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>12</span>:
</span></span><span style=display:flex><span>          clocks.add(KClock.new(tzofs))
</span></span><span style=display:flex><span>    button:
</span></span><span style=display:flex><span>      text <span style=color:#e6db74>&#34;Remove last Clock&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>proc </span><span style=color:#a6e22e>onclick</span>(ev: Event; n: VNode) <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>discard</span> clocks.pop()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> clock <span style=color:#f92672>in</span> clocks:
</span></span><span style=display:flex><span>      h1:
</span></span><span style=display:flex><span>        clock
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setRenderer render</span></span></code></pre></div><p>for Nim lovers, Karax looks promising, and programming web pages without writing a single Javascript line sounds very interesting; but currently it needs some polish, more documentation and a larger user base. So try and contribute to the development community!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ilmanzo.github.io/tags/nim/>Nim</a></li><li><a href=https://ilmanzo.github.io/tags/nim_language/>Nim_language</a></li><li><a href=https://ilmanzo.github.io/tags/web/>Web</a></li><li><a href=https://ilmanzo.github.io/tags/programming/>Programming</a></li></ul><nav class=paginav><a class=prev href=https://ilmanzo.github.io/post/openqa-jobs-notifier/><span class=title>« Prev</span><br><span>get notifications about openQA job status</span>
</a><a class=next href=https://ilmanzo.github.io/post/otp-generation-from-command-line/><span class=title>Next »</span><br><span>automate OTP credentials for multi-factor authentication</span></a></nav></footer></article></main><footer class=footer><span>© 2012-2025 Andrea Manzini</span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>